<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Central de Mudanças - Xcelis</title>
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="stylesheet" href="/css/gestao-planejamento.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
  <div class="dashboard-container">
    <!-- Barra Lateral -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <button class="toggle-sidebar">
          <i class="fas fa-bars"></i>
        </button>
      </div>
      <nav class="sidebar-nav">
        <a href="gestao-planejamento.html">
          <i class="fas fa-tasks"></i>
          <span>Gestão de Planejamento</span>
        </a>
        <a href="gmud-relatorio.html" class="active">
          <i class="fas fa-list-check"></i>
          <span>Central de Mudanças</span>
        </a>
        <a href="monitor-jobs/index.html">
          <i class="fas fa-server"></i>
          <span>Monitor de Jobs</span>
        </a>
        <a href="#" id="openChangePassword">
          <i class="fas fa-key"></i>
          <span>Alterar Senha</span>
        </a>
        <a href="gestao-sla.html" class="provisoriamente-oculto">
          <i class="fas fa-bolt"></i>
          <span>Gestão de SLA</span>
        </a>
        <a href="metas.html" class="provisoriamente-oculto">
          <i class="fas fa-flag-checkered"></i>
          <span>Metas & Planos</span>
        </a>
        <a href="relatorios.html" class="provisoriamente-oculto">
          <i class="fas fa-file-alt"></i>
          <span>Relatórios</span>
        </a>
      </nav>
      <div class="sidebar-footer">
        <h2>Xcelis</h2>
      </div>
    </aside>

    <!-- Conteúdo Principal -->
    <main class="main-content">
      <div class="container">
        <header class="header">
          <h1>Central de Mudanças</h1>
          <div class="subheader">
            <span id="ultimaAtualizacao" class="badge"></span>
          </div>
        </header>

        <div class="gmud-toolbar card sticky">
          <div class="actions">
            <button id="btnCarregar" class="btn btn-primary"><i class="fas fa-rotate"></i> Carregar</button>
            <button id="btnExportar" class="btn btn-secondary" disabled><i class="fas fa-download"></i> Exportar CSV</button>
          </div>
          <section class="filters">
            <div class="filter-group">
              <label for="dataInicial">Data inicial (produção)</label>
              <input type="date" id="dataInicial" placeholder="dd/mm/aaaa" />
            </div>
            <div class="filter-group">
              <label for="dataFinal">Data final (produção)</label>
              <input type="date" id="dataFinal" placeholder="dd/mm/aaaa" />
            </div>
            <div class="filter-actions">
              <button id="btnLimpar" type="button" class="btn btn-secondary">Limpar filtros</button>
            </div>
          </section>
        </div>

        <div id="gmud-status" class="alert" aria-live="polite"></div>

        <section>
          <table id="tabelaGMUD" class="table">
            <thead>
              <tr>
                <th data-sort="numero">Número</th>
                <th data-sort="titulo">Título</th>
                <th data-sort="categoria">Categoria</th>
                <th data-sort="projeto">Projeto</th>
                <th data-sort="squad">Squad</th>
                <th data-sort="data">Janela de Implantação</th>
                <th data-sort="gmud">Número GMUD</th>
                <th>Tempo</th>
                <th data-sort="documentacao">Documentação</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>
      </div>
    </main>
  </div>

  <script src="/js/config.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/utils.js"></script>
  <!-- Shared helpers (theme/navigation + modal handlers) -->
  <script src="/js/gestao-planejamento.js"></script>
  <script src="/js/gmud-relatorio.js"></script>
  
  <style>
    /* Estilos para a coluna Tempo */
    .table th:nth-child(8),
    .table td:nth-child(8) {
      width: 80px;
      min-width: 80px;
      text-align: center;
    }
    
    .table th:nth-child(8) {
      background-color: #e3f2fd;
      font-weight: 600;
      color: #1565c0;
    }
    
    /* Estilos para o botão de tempo */
    .btn-tempo-status {
      border: none !important;
      outline: none !important;
    }
    
    .btn-tempo-status:focus {
      box-shadow: 0 0 0 2px rgba(0,123,255,0.25) !important;
    }
    
    .btn-tempo-status:active {
      transform: translateY(1px) !important;
    }
    
    /* Estilos para a coluna de documentação */
    .table th[data-sort="documentacao"],
    .table td:nth-child(9) {
      width: 120px;
      min-width: 120px;
      text-align: center;
    }
    
    .table th[data-sort="documentacao"] {
      background-color: #f8f9fa;
      font-weight: 600;
    }
    
    /* Hover effect para ícones de documentação */
    .table td:nth-child(9) span {
      transition: transform 0.2s ease;
      display: inline-block;
    }
    
    .table td:nth-child(9) span:hover {
      transform: scale(1.2);
    }
    
    /* Estilos para linhas relacionadas */
    .related-row {
      background-color: #f8f9fa !important;
      opacity: 0.8;
    }
    
    .related-header-row {
      background-color: #e9ecef !important;
      font-weight: 600;
    }
    
    .related-header-row td {
      padding: 8px 12px;
      border-top: 2px solid #dee2e6;
    }
    
    /* Responsividade para telas menores */
    @media (max-width: 768px) {
      .table th:nth-child(8),
      .table td:nth-child(8) {
        width: 60px;
        min-width: 60px;
      }
      
      .table th[data-sort="documentacao"],
      .table td:nth-child(9) {
        width: 80px;
        min-width: 80px;
      }
      
      .btn-tempo-status {
        padding: 4px 6px !important;
        font-size: 10px !important;
      }
    }
  </style>
  <!-- Modal Alterar Senha (compartilhado) -->
  <div id="changePasswordModal" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-labelledby="cp-title" aria-modal="true">
      <h3 id="cp-title" style="margin-top:0;">Alterar Senha</h3>
      <div class="form-group">
        <label for="cp-current">Senha atual</label>
        <input type="password" id="cp-current" autocomplete="current-password" />
      </div>
      <div class="form-group">
        <label for="cp-new">Nova senha</label>
        <input type="password" id="cp-new" autocomplete="new-password" />
        <small class="hint">Mín. 8 caracteres, com maiúscula, minúscula, número e especial, sem espaços.</small>
      </div>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:12px;">
        <button id="cp-cancel" class="btn-secondary" type="button">Cancelar</button>
        <button id="cp-save" class="btn-primary" type="button">Salvar</button>
      </div>
    </div>
  </div>
</body>
</html>
